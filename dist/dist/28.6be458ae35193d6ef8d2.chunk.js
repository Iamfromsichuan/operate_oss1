webpackJsonp([28],{280:function(t,e,a){a(872);var s=a(4)(a(873),a(874),"data-v-22b9098e",null);s.options.__file="D:\\项目\\operate_oss\\src\\views\\masstexting\\masstexting.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] masstexting.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports},872:function(t,e){},873:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=a(96),n=s(o),i=a(14),l=s(i),r=a(62);e.default={computed:{url:function(){return"name1"===this.panelName?"/mass/data/select":"name2"===this.panelName?"/mass/task/select":"name3"===this.panelName?"/mass/log/select":"name5"===this.panelName?(this.nameIs4=!1,"/mass/redis/select"):(this.nameIs4=!0,"/mass/config/select")}},data:function(){var t=this;return{showCount:!1,nameIs4:!1,center:"center",panelName:"name1",currentName:"name1",dataLoading:!1,modalReset:!1,modalAdd:!1,modalCancel:!1,modalEdit:!1,modal_loading:!1,activityList:[],cityList:[],blackList:[],cheackedBlack:[],provinceList:[],redisList:[],coprObject:{},TotalRecords:0,params:{},pageConfig:[8,10,15,20,100],filter:{pageNo:1,pageSize:r.pageSize,activity:"",city:"",startDate:"",endDate:""},filter_reset:{id:"",status:0,isLocked:""},dataColumns:[{title:"活动名",key:"activity"},{title:"地州",key:"city"},{title:"目标用户数",key:"total"},{title:"已群发",key:"used"},{title:"重置状态",key:"status",render:function(t,e){var a=0===e.row.status?"待处理":1===e.row.status?"已处理":"处理中";return t("Button",{props:{type:0===e.row.status?"primary":1===e.row.status?"success":"warning"}},a)}},{title:"重置时间",key:"resetTime"},{title:"排序",key:"sort"},{title:"操作",width:200,render:function(e,a){return e("ButtonGroup",[e("Button",{props:{type:"success",icon:"plus",size:"small"},on:{click:function(){t.addInfo={},t.modalAdd=!0,t.addInfo.tableId=a.row.id,t.addInfo.proCode=a.row.proCode,t.addInfo.activity=a.row.activity,t.addInfo.city=a.row.city,t.addInfo.tableId=a.row.tableId,t.addInfo.status=a.row.status}}},"新增")])}}],dataList:[],resetId:"",addInfo:{},taskColumns:[{title:"活动名",key:"activity"},{title:"地州",key:"city"},{title:"开始时间",key:"startTime"},{title:"单次发送量",key:"sentCount"},{title:"循环次数",key:"sentNum"},{title:"任务状态",key:"status",render:function(t,e){return t("div",[t("span",{},0===e.row.status?"临时有效":"永久有效")])}},{title:"暂停切换",width:150,key:"isLocked",render:function(e,a){var s=0===a.row.isLocked?"执行中":"已暂停";return e("ButtonGroup",[e("Button",{props:{type:0===a.row.isLocked?"primary":"warning",icon:"refresh",size:"small"},on:{click:function(){t.dataLoading=!0;var e=new URLSearchParams,s=a.row.isLocked;e.append("id",a.row.id),e.append("isLocked",s=0==s?1:0),l.default.ajax.post("/mass/task/switch",e).then(function(e){t.dataLoading=!1,e.data.status==r.ERR_OK?a.row.isLocked=s:t.$Message.error(e.data.msg)})}}},s)])}},{title:"操作",key:"",render:function(e,a){return e("Button",{props:{type:"error",icon:"close"},on:{click:function(){t.modalCancel=!0,t.cancelId=a.row.id}}},"取消任务")}}],taskList:[],cancelId:"",logColumns:[{title:"执行时间",key:"createTime"},{title:"活动名称",key:"activity"},{title:"地州",key:"city"},{title:"开始时间",key:"startTime"},{title:"计划发送量",key:"planSentCount"},{title:"实际发送量",key:"lastSentCount"}],logList:[],configColumns:[{title:"活动表",key:"tableId"},{title:"活动名称",key:"activity"},{title:"活动状态",key:"status",render:function(t,e){return t("div",[t("span",{style:{color:1===e.row.status?"#4caf50":"red"}},1===e.row.status?"打开":"关闭")])}},{title:"顺序",key:"sort"},{title:"表名",key:"blackTable"},{title:"业务周期",key:"repeatDays",render:function(t,e){return t("div",[t("span",{},e.row.repeatDays+"天")])}},{title:"操作",render:function(e,a){return e("Button",{props:{type:"primary",size:"small",icon:"edit"},on:{click:function(){var e=t;l.default.ajax.get(l.default.baseUrl+"/mass/config/blackList").then(function(t){if(t.data.status==r.ERR_OK){e.blackList=t.data.data}else e.$Message.error(t.data.msg)}),t.editInfo=(0,n.default)({},a.row),t.coprObject=(0,n.default)({},t.editInfo),console.log(t.coprObject),t.cheackedBlack=t.coprObject.blackTable.split(","),1==t.cheackedBlack.length&&""==t.cheackedBlack&&(t.cheackedBlack=[]),t.modalEdit=!0}}},"修改")}}],redisColumns:[{title:"省份",key:"province"},{title:"缓存Db",key:"cacheDb"},{title:"缓存时间",key:"cacheTime"},{title:"备注",key:"remarks"},{title:"操作",render:function(e,a){return e("Button",{props:{type:"primary",size:"small",icon:"edit"},on:{click:function(){t.modalEdit=!0,t.editInfo=a.row,t.coprObject=(0,n.default)({},t.editInfo)}}},"修改")}}],configList:[],editInfo:{}}},methods:{sureShowCount:function(t){0==t?this.showCount=!0:-1==t&&(this.showCount=!1,this.addInfo.sentNum=1)},changePanel:function(t){t!==this.currentName&&(this.panelName=t,this.currentName=t,this.filter=(0,n.default)(this.filter,{activity:"",city:"",startDate:"",endDate:""}),"name4"!==t&&"name5"!==t||this.search(1))},getActivityList:function(){var t=this;l.default.ajax.get(l.default.baseUrl+"/mass/data/getActList").then(function(e){if(e.data.status==r.ERR_OK){var a=[];e.data.data.map(function(t){a.push({label:t,value:t})}),t.activityList=a}else t.$Message.error(e.data.msg)}).catch(function(t){console.log(t)})},getCityList:function(){var t=this;l.default.ajax.get(l.default.baseUrl+"/mass/data/getCitys").then(function(e){if(e.data.status==r.ERR_OK){var a=[];e.data.data.map(function(t){a.push({label:t,value:t})}),t.cityList=a}else t.$Message.error(e.data.msg)}).catch(function(t){console.log(t)})},getProvinceList:function(){var t=this;l.default.ajax.get(l.default.baseUrl+"/mass/config/getProList").then(function(e){if(e.data.status==r.ERR_OK){var a=[];e.data.data.map(function(t){a.push({label:t,value:t})}),t.provinceList=a}else t.$Message.error(e.data.msg)}).catch(function(t){console.log(t)})},dateChange:function(t){t?(this.filter.startTime=t[0],this.filter.endTime=t[1]):(this.filter.startTime="",this.filter.endTime="")},search:function(t){var e=this;this.dataLoading=!0,l.default.ajax.get(l.default.baseUrl+this.url,{params:e.filter}).then(function(t){if(e.dataLoading=!1,t.data.status==r.ERR_OK){var a=void 0;a=t.data.data.list?t.data.data.list:t.data.data,e.TotalRecords=t.data.data.total,"name1"===e.panelName?e.dataList=a:"name2"===e.panelName?e.taskList=a:"name3"===e.panelName?e.logList=a:"name5"===e.panelName?(console.log(a),e.redisList=a):e.configList=a}else e.$Message.error(t.data.msg)}).catch(function(t){console.log(t)})},changePage:function(t){this.filter.pageNo=t,this.search(t)},changePageSize:function(t){this.filter.pageSize=t,this.search(this.filter.pageNo)},reset:function(){var t=this;t.modal_loading=!0,l.default.ajax.get(l.default.baseUrl+"/mass/data/resetStatus",{params:t.filter_reset}).then(function(e){t.modal_loading=!1,e.data.status==r.ERR_OK?(t.modalReset=!1,t.$Message.success("操作成功！"),t.search(t.filter.pageNo)):t.$Message.error(e.data.msg)}).catch(function(t){console.log(t)})},add:function(){var t=this;t.modal_loading=!0,l.default.ajax.get(l.default.baseUrl+"/mass/task/addTask",{params:t.addInfo}).then(function(e){t.modal_loading=!1,e.data.status==r.ERR_OK?(t.modalAdd=!1,t.$Message.success("操作成功！"),t.search(t.filter.pageNo)):t.$Message.error(e.data.msg)}).catch(function(t){console.log(t)})},cancel:function(){var t=this;this.cancelId&&(t.modal_loading=!0,l.default.ajax.get(l.default.baseUrl+"/mass/task/cancelTask",{params:{id:t.cancelId}}).then(function(e){t.modal_loading=!1,e.data.status==r.ERR_OK?(t.modalCancel=!1,t.$Message.success("操作成功！"),t.search(t.filter.pageNo)):t.$Message.error(e.data.msg)}).catch(function(t){console.log(t)}))},edit:function(){var t=this;if(this.coprObject.blackTable="",this.cheackedBlack.length>=1)for(var e=0;e<this.cheackedBlack.length;e++)0==e?(console.log(1),this.coprObject.blackTable+=this.cheackedBlack[0]):(console.log(2),this.coprObject.blackTable+=","+this.cheackedBlack[e]);var a=this;a.modal_loading=!0;var s=null;"name4"===this.panelName?s="/mass/config/edit":"name5"===this.panelName&&(s="/mass/redis/edit"),l.default.ajax.get(l.default.baseUrl+s,{params:a.coprObject}).then(function(e){a.modalEdit=!1,a.loginLoading=!1,a.modal_loading=!1,t.search(1),e.data.status==r.ERR_OK?a.$Message.success("操作成功！"):t.$Message.error(e.data.msg)})}},mounted:function(){this.getActivityList(),this.getCityList(),this.getProvinceList()}}},874:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"massstexting"},[a("Tabs",{on:{"on-click":t.changePanel},model:{value:t.panelName,callback:function(e){t.panelName=e},expression:"panelName"}},[a("Select",{staticStyle:{width:"150px"},attrs:{slot:"extra",placeholder:"选择省份"},slot:"extra",model:{value:t.filter.proCode,callback:function(e){t.$set(t.filter,"proCode",e)},expression:"filter.proCode"}},t._l(t.provinceList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),a("TabPane",{attrs:{label:"群发数据列表",name:"name1"}},[a("Row",[a("Select",{staticStyle:{width:"200px"},attrs:{filterable:"",placeholder:"活动列表",clearable:!0},model:{value:t.filter.activity,callback:function(e){t.$set(t.filter,"activity",e)},expression:"filter.activity"}},t._l(t.activityList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),a("Button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){t.search(1)}}},[t._v("查询")])],1),t._v(" "),a("br"),t._v(" "),a("Table",{attrs:{columns:t.dataColumns,data:t.dataList,loading:t.dataLoading,align:t.center}})],1),t._v(" "),a("TabPane",{attrs:{label:"待群发任务列表",name:"name2"}},[a("Row",[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"活动列表"},model:{value:t.filter.activity,callback:function(e){t.$set(t.filter,"activity",e)},expression:"filter.activity"}},t._l(t.activityList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"城市列表"},model:{value:t.filter.city,callback:function(e){t.$set(t.filter,"city",e)},expression:"filter.city"}},t._l(t.cityList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),a("Button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){t.search(1)}}},[t._v("查询")])],1),t._v(" "),a("br"),t._v(" "),a("Table",{attrs:{columns:t.taskColumns,data:t.taskList,loading:t.dataLoading}})],1),t._v(" "),a("TabPane",{staticStyle:{"min-height":"300px"},attrs:{label:"群发日志列表",name:"name3"}},[a("Row",[a("Col",{attrs:{span:"12",offset:"4"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"活动列表"},model:{value:t.filter.activity,callback:function(e){t.$set(t.filter,"activity",e)},expression:"filter.activity"}},t._l(t.activityList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",placement:"bottom-end",placeholder:"起止时间",clearable:!0},on:{"on-change":t.dateChange}}),t._v(" "),a("Button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){t.search(1)}}},[t._v("查询")])],1)],1),t._v(" "),a("br"),t._v(" "),a("Table",{attrs:{columns:t.logColumns,data:t.logList,loading:t.dataLoading}})],1),t._v(" "),a("TabPane",{attrs:{label:"群发配置列表",name:"name4"}},[a("Table",{attrs:{columns:t.configColumns,data:t.configList,loading:t.dataLoading}})],1),t._v(" "),a("TabPane",{attrs:{label:"全局缓存配置",name:"name5"}},[a("Table",{attrs:{columns:t.redisColumns,data:t.redisList,loading:t.dataLoading}})],1)],1),t._v(" "),a("br"),t._v(" "),a("Page",{attrs:{total:t.TotalRecords,current:t.filter.pageNo,"page-size":t.filter.pageSize,"show-elevator":"","show-sizer":"",placement:"top","page-size-opts":t.pageConfig},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}}),t._v(" "),a("Modal",{attrs:{width:"360"},model:{value:t.modalReset,callback:function(e){t.modalReset=e},expression:"modalReset"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),t._v(" "),a("span",[t._v("重置活动")])],1),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("p",[t._v("此操作会重置活动数据")]),t._v(" "),a("p",[t._v("确定重置么？")])]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"error",size:"large",long:"",loading:t.modal_loading},on:{click:t.reset}},[t._v("重置")])],1)]),t._v(" "),a("Modal",{attrs:{width:"500"},model:{value:t.modalAdd,callback:function(e){t.modalAdd=e},expression:"modalAdd"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),t._v(" "),a("span",[t._v("添加群发任务")])],1),t._v(" "),a("div",[a("Row",{staticStyle:{"margin-bottom":"10px"}},[a("Col",{attrs:{span:"11"}},[a("Input",{attrs:{placeholder:"活动名称",disabled:""},model:{value:t.addInfo.activity,callback:function(e){t.$set(t.addInfo,"activity",e)},expression:"addInfo.activity"}})],1),t._v(" "),a("Col",{attrs:{span:"11",push:"2"}},[a("Input",{attrs:{placeholder:"省份编码",disabled:""},model:{value:t.addInfo.proCode,callback:function(e){t.$set(t.addInfo,"proCode",e)},expression:"addInfo.proCode"}})],1)],1),t._v(" "),a("Row",{staticStyle:{"margin-bottom":"10px"}},[a("Col",{attrs:{span:"11"}},[a("Select",{attrs:{placeholder:"地州"},model:{value:t.addInfo.city,callback:function(e){t.$set(t.addInfo,"city",e)},expression:"addInfo.city"}},t._l(t.cityList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),a("Col",{attrs:{span:"11",push:"2"}},[a("Input",{attrs:{placeholder:"开始时间"},model:{value:t.addInfo.startTime,callback:function(e){t.$set(t.addInfo,"startTime",e)},expression:"addInfo.startTime"}})],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("Input",{attrs:{placeholder:"单次发送量"},model:{value:t.addInfo.sentCount,callback:function(e){t.$set(t.addInfo,"sentCount",e)},expression:"addInfo.sentCount"}})],1),t._v(" "),a("Col",{attrs:{span:"11",push:"2"}},[a("Select",{attrs:{placeholder:"状态"},on:{"on-change":t.sureShowCount},model:{value:t.addInfo.status,callback:function(e){t.$set(t.addInfo,"status",e)},expression:"addInfo.status"}},[a("Option",{attrs:{value:"0"}},[t._v("临时任务")]),t._v(" "),a("Option",{attrs:{value:"-1"}},[t._v("永久任务")])],1)],1),t._v(" "),t.showCount?a("Col",{staticStyle:{"margin-top":"10px"},attrs:{span:"11"}},[a("Input",{attrs:{placeholder:"循环次数"},model:{value:t.addInfo.sentNum,callback:function(e){t.$set(t.addInfo,"sentNum",e)},expression:"addInfo.sentNum"}})],1):t._e()],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",size:"large",long:"",loading:t.modal_loading},on:{click:t.add}},[t._v("添加")])],1)]),t._v(" "),a("Modal",{attrs:{width:"360"},model:{value:t.modalCancel,callback:function(e){t.modalCancel=e},expression:"modalCancel"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),t._v(" "),a("span",[t._v("取消任务")])],1),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("p",[t._v("此操作会取消该任务")]),t._v(" "),a("p",[t._v("确定取消么？")])]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"error",size:"large",long:"",loading:t.modal_loading},on:{click:t.cancel}},[t._v("取消")])],1)]),t._v(" "),a("Modal",{attrs:{width:"360"},model:{value:t.modalEdit,callback:function(e){t.modalEdit=e},expression:"modalEdit"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),t._v(" "),a("span",[t._v("编辑活动")])],1),t._v(" "),a("div",[a("Input",{directives:[{name:"show",rawName:"v-show",value:t.nameIs4,expression:"nameIs4"}],staticStyle:{"margin-bottom":"10px"},attrs:{type:"textarea",placeholder:"活动内容",autosize:!0},model:{value:t.coprObject.content,callback:function(e){t.$set(t.coprObject,"content",e)},expression:"coprObject.content"}}),t._v(" "),a("Input",{directives:[{name:"show",rawName:"v-show",value:!t.nameIs4,expression:"!nameIs4"}],staticStyle:{"margin-bottom":"10px"},attrs:{type:"textarea",placeholder:"活动内容",autosize:!0},model:{value:t.coprObject.remarks,callback:function(e){t.$set(t.coprObject,"remarks",e)},expression:"coprObject.remarks"}}),t._v(" "),a("Col",{directives:[{name:"show",rawName:"v-show",value:!t.nameIs4,expression:"!nameIs4"}],staticStyle:{"margin-top":"10px"}},[t._v("缓存时间："),a("Input",{staticStyle:{width:"100px"},attrs:{placeholder:"Enter something..."},model:{value:t.coprObject.cacheTime,callback:function(e){t.$set(t.coprObject,"cacheTime",e)},expression:"coprObject.cacheTime"}}),t._v("天")],1),t._v(" "),a("Select",{directives:[{name:"show",rawName:"v-show",value:t.nameIs4,expression:"nameIs4"}],model:{value:t.coprObject.status,callback:function(e){t.$set(t.coprObject,"status",e)},expression:"coprObject.status"}},[a("Option",{key:1,attrs:{value:1}},[t._v("打开")]),t._v(" "),a("Option",{key:0,attrs:{value:0}},[t._v("关闭")])],1),t._v(" "),a("Select",{directives:[{name:"show",rawName:"v-show",value:t.nameIs4,expression:"nameIs4"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{slot:"extra",multiple:"",placeholder:"选择名单"},slot:"extra",model:{value:t.cheackedBlack,callback:function(e){t.cheackedBlack=e},expression:"cheackedBlack"}},t._l(t.blackList,function(e,s){return a("Option",{key:s,attrs:{value:e.tableId}},[t._v(t._s(e.remarks))])})),t._v(" "),a("Col",{directives:[{name:"show",rawName:"v-show",value:t.nameIs4,expression:"nameIs4"}],staticStyle:{"margin-top":"10px"}},[t._v("业务周期："),a("Input",{staticStyle:{width:"100px"},attrs:{placeholder:"Enter something..."},model:{value:t.coprObject.repeatDays,callback:function(e){t.$set(t.coprObject,"repeatDays",e)},expression:"coprObject.repeatDays"}}),t._v("天")],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",size:"large",long:"",loading:t.modal_loading},on:{click:t.edit}},[t._v("修改")])],1)])],1)},staticRenderFns:[]},t.exports.render._withStripped=!0}});