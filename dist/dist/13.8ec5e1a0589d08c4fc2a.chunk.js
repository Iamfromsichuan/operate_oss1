webpackJsonp([13],{279:function(e,t,a){a(868),a(869);var r=a(4)(a(870),a(871),"data-v-13a92c6c",null);r.options.__file="D:\\项目\\operate_oss\\src\\views\\complain\\complain_nation.vue",r.esModule&&Object.keys(r.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),r.options.functional&&console.error("[vue-loader] complain_nation.vue: functional components are not supported with templates, they should use render functions."),e.exports=r.exports},868:function(e,t){},869:function(e,t){},870:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(14),i=r(o),l=a(7),n=r(l),s=a(62);t.default={data:function(){var e=this;return{if_add:!0,collapseName:"1",initTime:(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate(),ruleValidate:{mobileNumber:[{required:!0,message:" ",trigger:"blur"}],complainTime:[{required:!0,message:" ",trigger:"blur"}],orderTime:[{required:!0,message:" ",trigger:"blur"}],orderProduct:[{required:!0,message:" ",trigger:"blur"}],province:[{required:!0,message:" ",trigger:"blur"}],businessType:[{required:!0,message:" ",trigger:"blur"}],refundSource:[{required:!0,message:" ",trigger:"blur"}]},cityList:[],modalDelete:!1,passWord:"",modalAdd:!1,modal_loading:!1,formItem:{},dataLoading:!1,filter:{pageNo:1,pageSize:s.pageSize,email:"",refundBusinessStatus:"",internalRefundStatus:"",oneRefundStatus:"",twoRefundStatus:"",complainStartTime:"",complainEndTime:"",orderStartTime:"",orderEndTime:"",endTime:"",mobileNumber:"",province:"",businessType:"",refundSource:""},TotalRecords:0,columns:[{type:"selection",width:60,align:"center"},{title:"号码",align:"center",key:"mobileNumber"},{title:"省份",align:"center",key:"province"},{title:"投诉日期",align:"center",key:"complainDate"},{title:"订购产品",align:"center",width:100,key:"orderProduct",render:function(e,t){return e("Tooltip",{props:{content:t.row.orderProduct,placement:"top-start"},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",width:"60px"}},t.row.orderProduct)}},{title:"业务类型",align:"center",key:"businessType"},{title:"订单来源",align:"center",key:"refundSource"},{title:"订购日期",align:"center",key:"orderData"},{title:"投诉内容",align:"center",key:"returnText"},{title:"备注",align:"center",key:"remarks"},{title:"客服",align:"center",key:"customer"},{title:"操作",align:"center",render:function(t,a){return t("Button",{props:{icon:"edit",type:"primary",size:"small"},on:{click:function(){e.modalAdd=!0,e.formItem=a.row,e.formItem={orderNo:a.row.orderNo,customer:a.row.customer,mobileNumber:a.row.mobileNumber,province:a.row.province,businessType:a.row.businessType,complainTime:a.row.complainDate,orderTime:a.row.orderData,refundSource:a.row.refundSource,orderProduct:a.row.orderProduct,returnText:a.row.returnText,remarks:a.row.remarks},e.if_add=!1}}},"编辑")}}],datas:[],orderNos:"",checkedDatas:[],pageConfig:[8,10,15,18,20,300]}},methods:{getCity:function(){var e=this;i.default.ajax.get(i.default.baseUrl+"/qgcu/tool/getProvince").then(function(t){t.data.status==s.ERR_OK?t.data.data.map(function(t){e.cityList.push({key:t,value:t})}):e.$Message.error(t.data.msg)}).catch(function(e){console.log(e)})},changeComplainTime:function(e){this.filter.complainStartTime=e[0]?e[0]+" 00:00:00":"",this.filter.complainEndTime=e[1]?e[1]+" 23:59:59":""},changeOrderTime:function(e){this.filter.orderStartTime=e[0]?e[0]+" 00:00:00":"",this.filter.orderEndTime=e[1]?e[1]+" 23:59:59":""},search:function(e){var t=this;this.filter.pageNo=e,this.dataLoading=!0,this.orderNos="",this.checkedDatas=[],i.default.ajax.get(i.default.baseUrl+"/qgcu/refund/list",{params:this.filter}).then(function(e){t.dataLoading=!1,e.data.status==s.ERR_OK?(t.datas=e.data.data.list,t.TotalRecords=e.data.data.total):t.$Message.error(e.data.msg)}).catch(function(e){console.log(e)})},selectItem:function(e){this.checkedDatas=e;var t=[];e.length?(e.map(function(e){t.push(e.orderNo)}),this.orderNos=t.join(",")):this.orderNos=""},changePageSize:function(e){this.filter.pageSize=e,this.search(1)},changePage:function(e){this.search(e)},deleteShow:function(){return this.checkedDatas.length?this.checkedDatas.length>1?void this.$Message.warning("一次只能删除一条订单！"):(this.passWord="",void(this.modalDelete=!0)):void this.$Message.warning("请选择需要删除的订单！")},deleteItem:function(){var e=this;if(!this.passWord)return void this.$Message.warning("请验证当前账户密码！");this.modal_loading=!0,i.default.ajax.get(i.default.baseUrl+"/qgcu/refund/delete",{params:{orderNo:e.checkedDatas[0].orderNo,userName:n.default.get("user"),passWord:e.passWord}}).then(function(t){e.modal_loading=!1,t.data.status==s.ERR_OK?(e.$Message.success("删除成功！"),e.modalDelete=!1,e.search(e.filter.pageNo)):e.$Message.error(t.data.msg)}).catch(function(e){console.log(e)})},exportOut:function(){var e=i.default.baseUrl+"/qgcu/refund/exportExcel?token="+n.default.get("token")+i.default.parseParam(this.filter);window.location.href=e},addShow:function(){this.modalAdd=!0,this.if_add=!0,this.formItem={customer:n.default.get("user"),mobileNumber:"",province:"",businessType:"月包",complainTime:this.initTime,orderTime:"",refundSource:"视窗",orderProduct:"",returnText:"用户否认订购行为。",remarks:""}},selectComplainTime:function(e){this.formItem.complainTime=e},selectOrderTime:function(e){this.formItem.orderTime=e},handleSubmit:function(e){var t=this,a=this,r=this.if_add?"/qgcu/refund/add":"/qgcu/refund/edit";this.$refs[e].validate(function(e){e?(t.modal_loading=!0,i.default.ajax.get(i.default.baseUrl+r,{params:a.formItem}).then(function(e){a.modal_loading=!1,e.data.status==s.ERR_OK?(a.$Message.success("添加成功！"),a.modalAdd=!1,a.search(1)):a.$Message.error(e.data.msg)}).catch(function(e){console.log(e)})):t.$Message.error("请填写完整退款信息!")})},downloadFile:function(e){window.location.href=i.default.baseUrl+"/xjcu/refund/downFile.do?fileName="+e}},created:function(){this.search(1),this.getCity()}}},871:function(e,t,a){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"complain_nation"},[a("Collapse",{staticStyle:{margin:"10px 0"},model:{value:e.collapseName,callback:function(t){e.collapseName=t},expression:"collapseName"}},[a("Panel",{attrs:{name:"1"}},[a("div",{staticStyle:{display:"inline-block",float:"left","margin-right":"10px"},on:{click:function(e){e.stopPropagation()}}},[a("Button",{attrs:{type:"success",icon:"plus"},on:{click:e.addShow}},[e._v("新增退款")]),e._v(" "),a("Button",{attrs:{type:"error",icon:"close"},on:{click:e.deleteShow}},[e._v("删除")]),e._v(" "),a("Button",{attrs:{type:"info",icon:"ios-cloud-download"},on:{click:e.exportOut}},[e._v("导出")])],1),e._v(" "),a("div",{attrs:{slot:"content"},slot:"content"},[a("Select",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{clearable:!0,placeholder:"业务类型"},model:{value:e.filter.businessType,callback:function(t){e.$set(e.filter,"businessType",t)},expression:"filter.businessType"}},[a("Option",{attrs:{value:"低消"}},[e._v("低消")]),e._v(" "),a("Option",{attrs:{value:"月包"}},[e._v("月包")]),e._v(" "),a("Option",{attrs:{value:"畅越"}},[e._v("畅越")]),e._v(" "),a("Option",{attrs:{value:"内容包"}},[e._v("内容包")]),e._v(" "),a("Option",{attrs:{value:"其他"}},[e._v("其他")])],1),e._v(" "),a("Select",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{clearable:!0,placeholder:"来源"},model:{value:e.filter.refundSource,callback:function(t){e.$set(e.filter,"refundSource",t)},expression:"filter.refundSource"}},[a("Option",{attrs:{value:"视窗短信"}},[e._v("视窗短信")]),e._v(" "),a("Option",{attrs:{value:"视窗"}},[e._v("视窗")]),e._v(" "),a("Option",{attrs:{value:"短信群发"}},[e._v("短信群发")]),e._v(" "),a("Option",{attrs:{value:"其他"}},[e._v("其他")])],1),e._v(" "),a("Select",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{clearable:!0,filterable:"",placeholder:"省份"},model:{value:e.filter.province,callback:function(t){e.$set(e.filter,"province",t)},expression:"filter.province"}},e._l(e.cityList,function(t){return a("Option",{key:"item",attrs:{value:t.key},domProps:{textContent:e._s(t.value)}})})),e._v(" "),a("datePicker",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{type:"daterange",placement:"bottom-start",placeholder:"投诉日期"},on:{"on-change":e.changeComplainTime}}),e._v(" "),a("datePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",placement:"bottom-start",placeholder:"订购日期"},on:{"on-change":e.changeOrderTime}}),e._v(" "),a("Button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){e.search(1)}}},[e._v("查找")])],1),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"right","margin-right":"10px",width:"150px"},on:{click:function(e){e.stopPropagation()}}},[a("Input",{staticStyle:{width:"90%"},attrs:{icon:"search",placeholder:"电话号码",clearable:!0},on:{"on-click":function(t){e.search(1)}},model:{value:e.filter.mobileNumber,callback:function(t){e.$set(e.filter,"mobileNumber",t)},expression:"filter.mobileNumber"}})],1)])],1),e._v(" "),a("Table",{attrs:{columns:e.columns,data:e.datas,loading:e.dataLoading,size:"small"},on:{"on-selection-change":e.selectItem}}),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"page"},[a("Page",{staticStyle:{display:"inline-block","vertical-align":"middle"},attrs:{total:e.TotalRecords,current:e.filter.pageNo,"page-size":e.filter.pageSize,"show-elevator":"","show-sizer":"",placement:"top","page-size-opts":e.pageConfig},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}}),e._v(" "),a("div",{staticClass:"records",staticStyle:{display:"inline-block",height:"32px","line-height":"32px","margin-left":"5%"}},[e._v("\n      当前共"),a("span",{staticStyle:{color:"#f00","font-weight":"bold"}},[e._v(" "+e._s(e.TotalRecords)+" ")]),e._v("条记录，已选定"),a("span",{staticStyle:{color:"#f00","font-weight":"bold"}},[e._v(" "+e._s(e.checkedDatas.length)+" ")]),e._v("条记录\n    ")])],1),e._v(" "),a("Modal",{attrs:{width:"660","mask-closable":!1,"class-name":"vertical-center-modal modalAdd"},model:{value:e.modalAdd,callback:function(t){e.modalAdd=t},expression:"modalAdd"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),e._v(" "),a("span",[e._v(e._s(e.if_add?"添加":"编辑")+"退费")]),e._v(" "),a("span",{staticClass:"customer",staticStyle:{position:"absolute",right:"8%",color:"#333"}},[e._v("\n        客服: "+e._s(e.formItem.customer)+"\n      ")])],1),e._v(" "),a("div",[a("Form",{ref:"formValidate",staticStyle:{width:"100%",margin:"0 auto"},attrs:{model:e.formItem,rules:e.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"号码",prop:"mobileNumber"}},[a("Input",{attrs:{placeholder:"投诉号码"},model:{value:e.formItem.mobileNumber,callback:function(t){e.$set(e.formItem,"mobileNumber",t)},expression:"formItem.mobileNumber"}})],1),e._v(" "),a("FormItem",{attrs:{label:"省份",prop:"province"}},[a("Select",{attrs:{clearable:!0,filterable:""},model:{value:e.formItem.province,callback:function(t){e.$set(e.formItem,"province",t)},expression:"formItem.province"}},e._l(e.cityList,function(t){return a("Option",{key:"item",attrs:{value:t.key},domProps:{textContent:e._s(t.value)}})}))],1),e._v(" "),a("FormItem",{attrs:{label:"业务类型",prop:"businessType"}},[a("Select",{attrs:{clearable:!0},model:{value:e.formItem.businessType,callback:function(t){e.$set(e.formItem,"businessType",t)},expression:"formItem.businessType"}},[a("Option",{attrs:{value:"低消"}},[e._v("低消")]),e._v(" "),a("Option",{attrs:{value:"月包"}},[e._v("月包")]),e._v(" "),a("Option",{attrs:{value:"畅越"}},[e._v("畅越")]),e._v(" "),a("Option",{attrs:{value:"内容包"}},[e._v("内容包")]),e._v(" "),a("Option",{attrs:{value:"其他"}},[e._v("其他")])],1)],1),e._v(" "),a("FormItem",{attrs:{label:"投诉日期",prop:"complainTime"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Select date",value:e.formItem.complainTime},on:{"on-change":e.selectComplainTime}})],1),e._v(" "),a("FormItem",{attrs:{label:"订购日期",prop:"orderTime"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Select date",value:e.formItem.orderTime},on:{"on-change":e.selectOrderTime}})],1),e._v(" "),a("FormItem",{attrs:{label:"订单来源",prop:"refundSource"}},[a("Select",{attrs:{clearable:!0},model:{value:e.formItem.refundSource,callback:function(t){e.$set(e.formItem,"refundSource",t)},expression:"formItem.refundSource"}},[a("Option",{attrs:{value:"视窗短信"}},[e._v("视窗短信")]),e._v(" "),a("Option",{attrs:{value:"视窗"}},[e._v("视窗")]),e._v(" "),a("Option",{attrs:{value:"短信群发"}},[e._v("短信群发")]),e._v(" "),a("Option",{attrs:{value:"其他"}},[e._v("其他")])],1)],1),e._v(" "),a("FormItem",{staticStyle:{width:"60%"},attrs:{label:"产品",prop:"orderProduct"}},[a("Input",{attrs:{placeholder:"订购产品"},model:{value:e.formItem.orderProduct,callback:function(t){e.$set(e.formItem,"orderProduct",t)},expression:"formItem.orderProduct"}})],1),e._v(" "),a("FormItem",{staticStyle:{width:"90%"},attrs:{label:"投诉内容"}},[a("Input",{attrs:{placeholder:"请输入回单文本"},model:{value:e.formItem.returnText,callback:function(t){e.$set(e.formItem,"returnText",t)},expression:"formItem.returnText"}})],1),e._v(" "),a("FormItem",{staticStyle:{width:"90%"},attrs:{label:"备注"}},[a("Input",{attrs:{placeholder:"请输入备注"},model:{value:e.formItem.remarks,callback:function(t){e.$set(e.formItem,"remarks",t)},expression:"formItem.remarks"}})],1)],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",loading:e.modal_loading},on:{click:function(t){e.handleSubmit("formValidate")}}},[e._v("提交")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:function(t){e.modalAdd=!1}}},[e._v("取消")])],1)]),e._v(" "),a("Modal",{attrs:{width:"320"},model:{value:e.modalDelete,callback:function(t){e.modalDelete=t},expression:"modalDelete"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),e._v(" "),a("span",[e._v("删除订单")])],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("Input",{attrs:{type:"password",autosize:!0,placeholder:"请验证当前用户密码"},model:{value:e.passWord,callback:function(t){e.passWord=t},expression:"passWord"}})],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",long:"",loading:e.modal_loading},on:{click:e.deleteItem}},[e._v("确认")])],1)])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}});